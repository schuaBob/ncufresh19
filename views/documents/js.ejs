<script>
    var textid = 0;
    $(document).ready(function () {

/*-----------------------------index------------------------------------------*/   

            //身分選擇動畫
            $(".identity").show();
            $(".under").hover(function(){
                $(this).addClass("big");
            },function(){
                $(this).removeClass("big");
            });
            $(".gra").hover(function(){
                $(this).addClass("big link");
            },function(){
                $(this).removeClass("big");
            });
            $(".com").hover(function(){
                $(this).addClass("big link");
            },function(){
                $(this).removeClass("big");
            });

/*-------------------------------其他頁面--------------------------------------*/            
            /*選單*/
            $(".icon1").hover(function(){
                $(this).attr('src','/documents/入學須知.png');
            },function(){
                $(this).attr('src','/documents/入學須知_原.png');
            });

            $(".icon2").hover(function(){
                $(this).attr('src','/documents/新生週.png');
            },function(){
                $(this).attr('src','/documents/新生週_原.png');
            });

            $(".icon3").hover(function(){
                $(this).attr('src','/documents/學習資訊.png');
            },function(){
                $(this).attr('src','/documents/學習資訊_原.png');
            });


/*--------------------------------------管理者---------------------------------------------*/

           ClassicEditor
            .create( document.querySelector( '#edit_content' ) )
            .catch( error => {
                console.error( error );
            } );
            var outeditor = undefined;
            ClassicEditor
            .create( document.querySelector( '#modify_content' ) )
            .then( neweditor => {
                console.log( neweditor );
                outeditor = neweditor;
            } )
            .catch( error => {
                console.error( error );
            } );


            

            //選擇新增或修改
 /*           $(".option").mousedown(function(){
                $("#edit_modify").modal("show");
                textid = this.id;
                //當下頁面變色
                $(".option").removeClass("page_now");
                $(this).addClass("page_now")
                
                $.ajax({
                url: "/documents/require_data/" + textid,
                method: 'get',
                error: function (err) {
                    console.log(err);
                },
                success: function (data) {
                    $("#show_title").empty();
                    $(".content").empty();
                    $("#show_title").html(data.title);  
                    $(".content").html(data.content);
                    }
            });
            })*/

            //新增
            $("#new_data").click(function (){
                $("#edit").modal("show");


                $("#save").click(function(){
                    $("#modify").modal("hide");
                });
            })
            
            //修改
            $("#modify_data").click(function (){
                //let textid = this.id; 
                $("#modify").modal("show");

                //將js的變數給html裡的form action
                $('#change').attr('action', "/documents/modify/" + textid);

                $.ajax({
                url: "/documents/require_data/" + textid,
                method: 'get',
                error: function (err) {
                    console.log(err);
                },
                success: function (data) {
                    $("#modify_title").val(data.title);
                    outeditor.setData(data.content);
                    }
            });

                $("#save").click(function(){
                    $("#modify").modal("hide");
                });
            })

        
            //調整modal跳出來的位置
            $('#edit').on('show.bs.modal', function () {
                $(this).css("top","20%");
            })
            $('#modify').on('show.bs.modal', function () {
                $(this).css("top","20%");
            })
            $('#edit_modify').on('show.bs.modal', function () {
                $(this).css("top","20%");
            })
            
/*--------------------------------------使用者---------------------------------------------*/
//當下頁面變色

var url = new URL(window.location.href);
var option = 0;
            url = url.href.split('/');
            option = document.getElementById(url[5]);
            $(option).addClass("page_now");
           

            
            //判斷套用哪個layout
            $(".option").mousedown(function(){
                textid = this.id;
                if(url[4]=='undergraduate_must'){
                    $(this).attr('href',"/documents/undergraduate_must/"+textid);
                }
                if(url[4]=='undergraduate_fresh'){
                    $(this).attr('href',"/documents/undergraduate_fresh/"+textid);
                }
                if(url[4]=='undergraduate_study'){
                    $(this).attr('href',"/documents/undergraduate_study/"+textid);
                }
                if(url[4]=='graduate_must'){
                    $(this).attr('href',"/documents/graduate_must/"+textid);
                }
                if(url[4]=='graduate_fresh'){
                    $(this).attr('href',"/documents/graduate_fresh/"+textid);
                }
                if(url[4]=='common'){
                    $(this).attr('href',"/documents/common/"+textid);
                }

            })        
         

    })


    //新增的時候將id傳到modal
    function getid(){
        $('input[name=id]').val(textid);
    }

</script>